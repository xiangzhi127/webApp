this.seajs = {
    _seajs: this.seajs
},
seajs.version = "%VERSION%",
seajs._util = {},
seajs._config = {
    debug: "%DEBUG%",
    preload: []
},
function(e) {
    var t = Object.prototype.toString
      , n = Array.prototype;
    e.isString = function(e) {
        return t.call(e) === "[object String]"
    }
    ,
    e.isFunction = function(e) {
        return t.call(e) === "[object Function]"
    }
    ,
    e.isRegExp = function(e) {
        return t.call(e) === "[object RegExp]"
    }
    ,
    e.isObject = function(e) {
        return e === Object(e)
    }
    ,
    e.isArray = Array.isArray || function(e) {
        return t.call(e) === "[object Array]"
    }
    ,
    e.indexOf = n.indexOf ? function(e, t) {
        return e.indexOf(t)
    }
    : function(e, t) {
        for (var n = 0; n < e.length; n++)
            if (e[n] === t)
                return n;
        return -1
    }
    ;
    var r = e.forEach = n.forEach ? function(e, t) {
        e.forEach(t)
    }
    : function(e, t) {
        for (var n = 0; n < e.length; n++)
            t(e[n], n, e)
    }
    ;
    e.map = n.map ? function(e, t) {
        return e.map(t)
    }
    : function(e, t) {
        var n = [];
        return r(e, function(e, r, i) {
            n.push(t(e, r, i))
        }),
        n
    }
    ,
    e.filter = n.filter ? function(e, t) {
        return e.filter(t)
    }
    : function(e, t) {
        var n = [];
        return r(e, function(e, r, i) {
            t(e, r, i) && n.push(e)
        }),
        n
    }
    ;
    var i = e.keys = Object.keys || function(e) {
        var t = [];
        for (var n in e)
            e.hasOwnProperty(n) && t.push(n);
        return t
    }
    ;
    e.unique = function(e) {
        var t = {};
        return r(e, function(e) {
            t[e] = 1
        }),
        i(t)
    }
    ,
    e.now = Date.now || function() {
        return (new Date).getTime()
    }
}(seajs._util),
function(e) {
    e.log = function() {
        if (typeof console == "undefined")
            return;
        var e = Array.prototype.slice.call(arguments)
          , t = "log"
          , n = e[e.length - 1];
        console[n] && (t = e.pop());
        if (t === "log" && !seajs.debug)
            return;
        if (console[t].apply) {
            console[t].apply(console, e);
            return
        }
        var r = e.length;
        r === 1 ? console[t](e[0]) : r === 2 ? console[t](e[0], e[1]) : r === 3 ? console[t](e[0], e[1], e[2]) : console[t](e.join(" "))
    }
}(seajs._util),
function(e, t, n) {
    function u(e) {
        var t = e.match(r);
        return (t ? t[0] : ".") + "/"
    }
    function a(e) {
        i.lastIndex = 0,
        i.test(e) && (e = e.replace(i, "$1/"));
        if (e.indexOf(".") === -1)
            return e;
        var t = e.split("/"), n = [], r;
        for (var s = 0; s < t.length; s++) {
            r = t[s];
            if (r === "..") {
                if (n.length === 0)
                    throw new Error("The path is invalid: " + e);
                n.pop()
            } else
                r !== "." && n.push(r)
        }
        return n.join("/")
    }
    function f(e) {
        e = a(e);
        var t = e.charAt(e.length - 1);
        return t === "/" ? e : (t === "#" ? e = e.slice(0, -1) : e.indexOf("?") === -1 && !s.test(e) && (e += ".js"),
        e.indexOf(":80/") > 0 && (e = e.replace(":80/", "/")),
        e)
    }
    function l(e) {
        if (e.charAt(0) === "#")
            return e.substring(1);
        var n = t.alias;
        if (n && y(e)) {
            var r = e.split("/")
              , i = r[0];
            n.hasOwnProperty(i) && (r[0] = n[i],
            e = r.join("/"))
        }
        return e
    }
    function h(n) {
        var r = t.map || [];
        if (!r.length)
            return n;
        var i = n;
        for (var s = 0; s < r.length; s++) {
            var o = r[s];
            if (e.isArray(o) && o.length === 2) {
                var f = o[0];
                if (e.isString(f) && i.indexOf(f) > -1 || e.isRegExp(f) && f.test(i))
                    i = i.replace(f, o[1])
            } else
                e.isFunction(o) && (i = o(i))
        }
        return v(i) || (i = a(u(E) + i)),
        i !== n && (c[i] = n),
        i
    }
    function p(e) {
        return c[e] || e
    }
    function d(e, n) {
        if (!e)
            return "";
        e = l(e),
        n || (n = E);
        var r;
        return v(e) ? r = e : m(e) ? (e.indexOf("./") === 0 && (e = e.substring(2)),
        r = u(n) + e) : g(e) ? r = n.match(o)[1] + e : r = t.base + "/" + e,
        r = r.replace("http://dynamic.", "http://"),
        f(r)
    }
    function v(e) {
        return e.indexOf("://") > 0 || e.indexOf("//") === 0
    }
    function m(e) {
        return e.indexOf("./") === 0 || e.indexOf("../") === 0
    }
    function g(e) {
        return e.charAt(0) === "/" && e.charAt(1) !== "/"
    }
    function y(e) {
        var t = e.charAt(0);
        return e.indexOf("://") === -1 && t !== "." && t !== "/"
    }
    function b(e) {
        return e.charAt(0) !== "/" && (e = "/" + e),
        e
    }
    var r = /.*(?=\/.*$)/
      , i = /([^:\/])\/\/+/g
      , s = /\.(?:css|js)$/
      , o = /^(.*?\w)(?:\/|$)/
      , c = {}
      , w = n.location
      , E = w.protocol + "//" + w.host + b(w.pathname);
    E.indexOf("\\") > 0 && (E = E.replace(/\\/g, "/")),
    e.dirname = u,
    e.realpath = a,
    e.normalize = f,
    e.parseAlias = l,
    e.parseMap = h,
    e.unParseMap = p,
    e.id2Uri = d,
    e.isAbsolute = v,
    e.isRoot = g,
    e.isTopLevel = y,
    e.pageUri = E
}(seajs._util, seajs._config, this),
function(e, t) {
    function f(e, t) {
        e.nodeName === "SCRIPT" ? l(e, t) : c(e, t)
    }
    function l(e, n) {
        e.onload = e.onerror = e.onreadystatechange = function() {
            o.test(e.readyState) && (e.onload = e.onerror = e.onreadystatechange = null ,
            e.parentNode && !t.debug && r.removeChild(e),
            e = undefined,
            n())
        }
    }
    function c(t, n) {
        v || m ? (e.log("Start poll to fetch css"),
        setTimeout(function() {
            h(t, n)
        }, 1)) : t.onload = t.onerror = function() {
            t.onload = t.onerror = null ,
            t = undefined,
            n()
        }
    }
    function h(e, t) {
        var n;
        if (v)
            e.sheet && (n = !0);
        else if (e.sheet)
            try {
                e.sheet.cssRules && (n = !0)
            } catch (r) {
                r.name === "NS_ERROR_DOM_SECURITY_ERR" && (n = !0)
            }
        setTimeout(function() {
            n ? t() : h(e, t)
        }, 1)
    }
    function p() {}
    var n = document, r = n.head || n.getElementsByTagName("head")[0] || n.documentElement, i = r.getElementsByTagName("base")[0], s = /\.css(?:\?|$)/i, o = /loaded|complete|undefined/, u, a;
    e.fetch = function(t, n, o) {
        var a = s.test(t)
          , l = document.createElement(a ? "link" : "script");
        if (o) {
            var c = e.isFunction(o) ? o(t) : o;
            c && (l.charset = c)
        }
        f(l, n || p),
        a ? (l.rel = "stylesheet",
        l.href = t) : (l.async = "async",
        l.src = t),
        u = l,
        i ? r.insertBefore(l, i) : r.appendChild(l),
        u = null
    }
    ,
    e.getCurrentScript = function() {
        if (u)
            return u;
        if (a && a.readyState === "interactive")
            return a;
        var e = r.getElementsByTagName("script");
        for (var t = 0; t < e.length; t++) {
            var n = e[t];
            if (n.readyState === "interactive")
                return a = n,
                n
        }
    }
    ,
    e.getScriptAbsoluteSrc = function(e) {
        return e.hasAttribute ? e.src : e.getAttribute("src", 4)
    }
    ,
    e.importStyle = function(e, t) {
        if (t && n.getElementById(t))
            return;
        var i = n.createElement("style");
        t && (i.id = t),
        r.appendChild(i),
        i.styleSheet ? i.styleSheet.cssText = e : i.appendChild(n.createTextNode(e))
    }
    ;
    var d = navigator.userAgent
      , v = Number(d.replace(/.*AppleWebKit\/(\d+)\..*/, "$1")) < 536
      , m = d.indexOf("Firefox") > 0 && !("onload"in document.createElement("link"))
}(seajs._util, seajs._config, this),
function(e) {
    function n(e) {
        return e.replace(/^\s*\/\*[\s\S]*?\*\/\s*$/mg, "").replace(/^\s*\/\/.*$/mg, "")
    }
    var t = /(?:^|[^.$])\brequire\s*\(\s*(["'])([^"'\s\)]+)\1\s*\)/g;
    e.parseDependencies = function(r) {
        var i = [], s;
        r = n(r),
        t.lastIndex = 0;
        while (s = t.exec(r))
            s[2] && i.push(s[2]);
        return e.unique(i)
    }
}(seajs._util),
function(e, t, n) {
    function u(e, t) {
        this.uri = e,
        this.status = t || 0
    }
    function d(e, n) {
        return t.isString(e) ? u._resolve(e, n) : t.map(e, function(e) {
            return d(e, n)
        })
    }
    function v(e, i) {
        var s = t.parseMap(e);
        if (f[s]) {
            i();
            return
        }
        if (a[s]) {
            l[s].push(i);
            return
        }
        a[s] = !0,
        l[s] = [i],
        u._fetch(s, function() {
            f[s] = !0;
            var n = r[e];
            n.status === o.FETCHING && (n.status = o.FETCHED),
            c && (u._save(e, c),
            c = null ),
            h && n.status === o.FETCHED && (r[e] = h,
            h.realUri = e),
            h = null ,
            a[s] && delete a[s];
            var i = l[s];
            i && (delete l[s],
            t.forEach(i, function(e) {
                e()
            }))
        }, n.charset)
    }
    function m(e, n) {
        var i = r[e] || (r[e] = new u(e));
        return i.status < o.SAVED && (i.id = n.id || e,
        i.dependencies = d(t.filter(n.dependencies || [], function(e) {
            return !!e
        }), e),
        i.factory = n.factory,
        i.status = o.SAVED),
        i
    }
    function g(e, t) {
        var n = e(t.require, t.exports, t);
        n !== undefined && (t.exports = n)
    }
    function y(e) {
        return !!i[e.realUri || e.uri]
    }
    function b(e) {
        var n = e.realUri || e.uri
          , r = i[n];
        r && (t.forEach(r, function(t) {
            g(t, e)
        }),
        delete i[n])
    }
    function w(e) {
        var n = e.uri;
        return t.filter(e.dependencies, function(e) {
            p = [n];
            var t = E(r[e]);
            return t && (p.push(n),
            S(p)),
            !t
        })
    }
    function E(e) {
        if (!e || e.status !== o.SAVED)
            return !1;
        p.push(e.uri);
        var t = e.dependencies;
        if (t.length) {
            if (x(t, p))
                return !0;
            for (var n = 0; n < t.length; n++)
                if (E(r[t[n]]))
                    return !0
        }
        return p.pop(),
        !1
    }
    function S(e, n) {
        t.log("Found circular dependencies:", e.join(" --> "), n)
    }
    function x(e, n) {
        var r = e.concat(n);
        return r.length > t.unique(r).length
    }
    function T(e) {
        var t = n.preload.slice();
        n.preload = [],
        t.length ? N._use(t, e) : e()
    }
    var r = {}
      , i = {}
      , s = []
      , o = {
        FETCHING: 1,
        FETCHED: 2,
        SAVED: 3,
        READY: 4,
        COMPILING: 5,
        COMPILED: 6
    };
    u.prototype._use = function(e, n) {
        t.isString(e) && (e = [e]);
        var i = d(e, this.uri);
        this._load(i, function() {
            T(function() {
                var e = t.map(i, function(e) {
                    return e ? r[e]._compile() : null
                });
                n && n.apply(null , e)
            })
        })
    }
    ,
    u.prototype._load = function(e, n) {
        function l(e) {
            (e || {}).status < o.READY && (e.status = o.READY),
            --a === 0 && n()
        }
        var i = t.filter(e, function(e) {
            return e && (!r[e] || r[e].status < o.READY)
        })
          , s = i.length;
        if (s === 0) {
            n();
            return
        }
        var a = s;
        for (var f = 0; f < s; f++)
            (function(e) {
                function n() {
                    t = r[e];
                    if (t.status >= o.SAVED) {
                        var n = w(t);
                        n.length ? u.prototype._load(n, function() {
                            l(t)
                        }) : l(t)
                    } else
                        l()
                }
                var t = r[e] || (r[e] = new u(e,o.FETCHING));
                t.status >= o.FETCHED ? n() : v(e, n)
            })(i[f])
    }
    ,
    u.prototype._compile = function() {
        function n(t) {
            var n = d(t, e.uri)
              , i = r[n];
            return i ? i.status === o.COMPILING ? i.exports : (i.parent = e,
            i._compile()) : null
        }
        var e = this;
        if (e.status === o.COMPILED)
            return e.exports;
        if (e.status < o.SAVED && !y(e))
            return null ;
        e.status = o.COMPILING,
        n.async = function(t, n) {
            e._use(t, n)
        }
        ,
        n.resolve = function(t) {
            return d(t, e.uri)
        }
        ,
        n.cache = r,
        e.require = n,
        e.exports = {};
        var i = e.factory;
        return t.isFunction(i) ? (s.push(e),
        g(i, e),
        s.pop()) : i !== undefined && (e.exports = i),
        e.status = o.COMPILED,
        b(e),
        e.exports
    }
    ,
    u._define = function(e, n, i) {
        var s = arguments.length;
        s === 1 ? (i = e,
        e = undefined) : s === 2 && (i = n,
        n = undefined,
        t.isArray(e) && (n = e,
        e = undefined)),
        !t.isArray(n) && t.isFunction(i) && (n = t.parseDependencies(i.toString()));
        var a = {
            id: e,
            dependencies: n,
            factory: i
        }, f;
        if (document.attachEvent) {
            var l = t.getCurrentScript();
            l && (f = t.unParseMap(t.getScriptAbsoluteSrc(l))),
            f || t.log("Failed to derive URI from interactive script for:", i.toString(), "warn")
        }
        var p = e ? d(e) : f;
        if (p) {
            if (p === f) {
                var v = r[f];
                v && v.realUri && v.status === o.SAVED && (r[f] = null )
            }
            var m = u._save(p, a);
            f ? (r[f] || {}).status === o.FETCHING && (r[f] = m,
            m.realUri = f) : h || (h = m)
        } else
            c = a
    }
    ,
    u._getCompilingModule = function() {
        return s[s.length - 1]
    }
    ,
    u._find = function(e) {
        var n = [];
        return t.forEach(t.keys(r), function(i) {
            if (t.isString(e) && i.indexOf(e) > -1 || t.isRegExp(e) && e.test(i)) {
                var s = r[i];
                s.exports && n.push(s.exports)
            }
        }),
        n
    }
    ,
    u._modify = function(t, n) {
        var s = d(t)
          , u = r[s];
        return u && u.status === o.COMPILED ? g(n, u) : (i[s] || (i[s] = []),
        i[s].push(n)),
        e
    }
    ,
    u.STATUS = o,
    u._resolve = t.id2Uri,
    u._fetch = t.fetch,
    u._save = m;
    var a = {}
      , f = {}
      , l = {}
      , c = null
      , h = null
      , p = []
      , N = new u(t.pageUri,o.COMPILED);
    e.use = function(t, n) {
        return T(function() {
            N._use(t, n)
        }),
        e
    }
    ,
    e.define = u._define,
    e.cache = u.cache = r,
    e.find = u._find,
    e.modify = u._modify,
    u.fetchedList = f,
    e.pluginSDK = {
        Module: u,
        util: t,
        config: n
    }
}(seajs, seajs._util, seajs._config),
function(e, t, n) {
    function l() {
        e.debug = !!n.debug
    }
    function c(e) {
        if (e.indexOf("??") === -1)
            return e;
        var n = e.split("??")
          , r = n[0]
          , i = t.filter(n[1].split(","), function(e) {
            return e.indexOf("sea.js") !== -1
        });
        return r + i[0]
    }
    function h(e, n, r) {
        e && e !== n && t.log("The alias config is conflicted:", "key =", '"' + r + '"', "previous =", '"' + e + '"', "current =", '"' + n + '"', "warn")
    }
    var r = "seajs-ts="
      , i = r + t.now()
      , s = document.getElementById("seajsnode");
    if (!s) {
        var o = document.getElementsByTagName("script");
        s = o[o.length - 1]
    }
    var u = s && t.getScriptAbsoluteSrc(s) || t.pageUri
      , a = t.dirname(c(u));
    t.loaderDir = a;
    var f = a.match(/^(.+\/)seajs\/[\.\d]+(?:-dev)?\/$/);
    f && (a = f[1]),
    n.base = a,
    n.main = s && s.getAttribute("data-main"),
    n.charset = "utf-8",
    e.config = function(s) {
        for (var o in s) {
            if (!s.hasOwnProperty(o))
                continue;
            var u = n[o]
              , a = s[o];
            if (u && o === "alias") {
                for (var f in a)
                    if (a.hasOwnProperty(f)) {
                        var c = u[f]
                          , p = a[f];
                        /^\d+\.\d+\.\d+$/.test(p) && (p = f + "/" + p + "/" + f),
                        h(c, p, f),
                        u[f] = p
                    }
            } else
                !u || o !== "map" && o !== "preload" ? n[o] = a : (t.isString(a) && (a = [a]),
                t.forEach(a, function(e) {
                    e && u.push(e)
                }))
        }
        var d = n.base;
        return d && !t.isAbsolute(d) && (n.base = t.id2Uri((t.isRoot(d) ? "" : "./") + d + "/")),
        n.debug === 2 && (n.debug = 1,
        e.config({
            map: [[/^.*$/, function(e) {
                return e.indexOf(r) === -1 && (e += (e.indexOf("?") === -1 ? "?" : "&") + i),
                e
            }
            ]]
        })),
        l(),
        this
    }
    ,
    l()
}(seajs, seajs._util, seajs._config),
function(e, t, n) {
    function r() {
        var e = []
          , r = n.location.search;
        return r = r.replace(/(seajs-\w+)(&|$)/g, "$1=1$2"),
        r += " " + document.cookie,
        r.replace(/seajs-(\w+)=[1-9]/g, function(t, n) {
            e.push(n)
        }),
        t.unique(e)
    }
    e.log = t.log,
    e.importStyle = t.importStyle,
    e.config({
        alias: {
            seajs: t.loaderDir
        }
    }),
    t.forEach(r(), function(t) {
        e.use("seajs/plugin-" + t),
        t === "debug" && (e._use = e.use,
        e._useArgs = [],
        e.use = function() {
            return e._useArgs.push(arguments),
            e
        }
        )
    })
}(seajs, seajs._util, this),
function(e, t, n) {
    var r = e._seajs;
    if (r && !r.args) {
        n.seajs = e._seajs;
        return
    }
    n.define = e.define,
    t.main && e.use(t.main),
    function(t) {
        if (t) {
            var n = {
                0: "config",
                1: "use",
                2: "define"
            };
            for (var r = 0; r < t.length; r += 2)
                e[n[t[r]]].apply(e, t[r + 1])
        }
    }((r || 0).args),
    n.define.cmd = {},
    delete e.define,
    delete e._util,
    delete e._config,
    delete e._seajs
}(seajs, seajs._config, this);
seajs.config({
    base: (window.m2015Config && window.m2015Config.cdnHost || "") + "/site/m2015/js/",
    alias: {
        "zepto": "lib/zepto/1.1.6/zepto.min.js",
        "zepto_1.1.3": "lib/zepto/1.1.3/zepto.min.js",
        "jquery": "lib/jquery/1.11.0/jquery.min.js",
        "test": "plugins/test.min.js",
        "QRcode": "plugins/QRcode/QRcode.js",
        "zepto.cookie": "plugins/zepto/zepto.cookie.min.js",
        "zepto.animate": "plugins/zepto/zepto.animate.min.js",
        "zepto.raty": "plugins/zepto/zepto.raty.min.js",
        "zepto.deferred": "plugins/zepto/zepto.deferred.min.js",
        "slide": "components/slide/slide_wap.min.js",
        "filterbar": "components/filter/filter.min.js",
        "console": "plugins/debug/console.min.js",
        "base64": "plugins/base64/base64.min.js",
        "manager": "plugins/manager/manager.min.js",
        "template": "plugins/template/template.min.js",
        "hammer": "plugins/hammer/hammer.min.js",
        "base-info": "plugins/base-info/base-info.min.js",
        "cookie": "plugins/cookie/cookie.min.js",
        "touch-slider": "components/touch-slider/touch-slider.min.js",
        "responsive-image": "components/responsive-image/responsive-image.min.js",
        "channel-responsive": "components/responsive/channel.js",
        "dialog30": "components/dialog30/dialog.min.js",
        "dialog": "plugins/dialog/dialog.min.js",
        "dialogPx": "plugins/dialog/dialogPx.js",
        "moment": "plugins/moment/moment.min.js",
        "Storage": "plugins/storage/Storage.min.js",
        "TN_cache": "plugins/storage/TN_cache.min.js",
        "verify-set": "plugins/verify/verify-set.min.js",
        "verify-code": "plugins/verify/verify-code.min.js",
        "Citys": "components/cityrender/cityrender.min.js",
        "Cityrender": "plugins/cityrender/cityrender02.js",
        "intlCityrender": "plugins/cityrender/intlCityrender.js",
        "Calendar": "components/calendar/calendar.min.js",
        "calendar": "plugins/calendar/calendar.js",
        "Calendar_new": "plugins/calendar/calendar_new.js",
        "calendar30": "components/calendar/calendar30.js",
        "dateEx": "plugins/dateExtend/date.min.js",
        "hotelUtils": "modules/hotel/common.min.js",
        "TN_ajax": "plugins/ajax/ajax.min.js",
        "wechatcard": "plugins/wechat/wechatCard.min.js",
        "PriceCalendarList": "components/PriceCalendarList/PriceCalendarList.min.js",
        "Waterfall": "components/waterfall/waterfall.min.js",
        "eventEmitter": "plugins/eventEmitter/eventEmitter.min.js",
        "iscroll": "components/iscroll/iscroll.min.js",
        "iscroll5.1.2": "components/iscroll/iscroll5.1.2.min.js",
        "Scrollbar": "components/scrollbar/scrollbar.min.js",
        "gps": "global/gps.min.js",
        "bridge": "global/bridge.min.js",
        "React": "lib/react/0.13.3/react.min.js",
        "vue": "lib/vue/1.0/vue.js",
        "socket": "plugins/socket/socket.min.js",
        "bootstrap": "plugins/bootstrap/bootstrap.min.js",
        "mTemplate": "modules/onlineChat/widget/mTemplate.min.js",
        "mUtils": "modules/onlineChat/widget/mutils.min.js",
        "unveil": "plugins/unveil/unveil.js",
        "commonTrip": "modules/trips/common.js",
        "TN_microshop": "plugins/microShop/microShop.js",
        "lazyload": "plugins/lazyload/lazyload.min.js",
        "mallAddress": "components/mall/address.min.js",
        "TN_visitors": "plugins/visitors/visitors.min.js",
        "TN_visitor": "components/visitor/visitor.min.js",
        "companionShowHead": "components/companion/show-head.min.js",
        "number-chooser": "components/number-chooser/number-chooser.min.js",
        "iscrollZoom": "components/iscroll/iscroll-zoom.min.js",
        "lanternSlide": "components/lantern-slide/lantern-slide.min.js",
        "director": "plugins/director/director.min.js",
        "sticky": "components/sticky/sticky.min.js",
        "stickyNav": "components/sticky/sticky-nav.min.js",
        "listFilterBar": "components/search/filter-bar.min.js",
        "dateSelector": "components/dateSelector/dateSelector.min.js",
        "url": "plugins/url/url.min.js",
        "validation": "plugins/validation/validation.min.js",
        "flightUtils": "modules/flight/flightUtils.js",
        "underscore": "plugins/underscore/underscore.js",
        "TN_waterfall": "plugins/waterfall/waterfall.js",
        "checker": "plugins/check/checker.js",
        "adSlider": "plugins/slider/slider.min.js",
        "passenger": "plugins/passengers/passenger.js",
        "swipe": "components/swipe/swipe.min.js",
        "coach_check": "modules/coach/checkcardid.js",
        "hotelCommon": "modules/hotel/common.js",
        "hotelListShow": "modules/hotel/listShow.js",
        "hotelInOutSelect": "modules/hotel/checkin-checkout-select.js",
        "calendarHotel": "modules/hotel/common/calendarHotel.js",
        "hotelVerification": "modules/hotel/verification.js",
        "hotelChoose": "modules/hotel/choosenum.js",
        "lisPlus": "plugins/lisPlusV1/lisPlus.js",
        "TN_Pass": "modules/flight/passenger.js",
        "sourceDelModle": "modules/flight/sourceMod.js",
        "refuseModle": "modules/flight/refuseMod.js",
        "insureModle": "modules/flight/insureMod.js",
        "priceDetailModle": "modules/flight/priceDetailMod.js",
        "cityRenderV2": "plugins/cityrender/cityrenderV2.js",
        'scrollTab': 'plugins/scrollTab/scrollTab.js',
        "scroll": "plugins/scroll/Scrollbar.min.js",
        "PriceCalendarListV1": "plugins/calendar/PriceCalendarList.js",
        "gpsV1": "global/gpsV1.js",
        "filter": "modules/flight/filter.js",
        "passCheckName": "modules/flight/checkName.js",
        "tnCache": "modules/flight/plugin/tnCache/tnCache.js",
        "train-calendar": "modules/train/calendar.js",
        "train-dialog": "modules/train/dialog.js",
        "Cityrender_train": "modules/train/cityrender.js",
        "train-data": "modules/train/dataPass.js",
        "train-common": "modules/train/modules/trainCommon.js",
        "DateSelectorPanel": "modules/atoc/dateSelector/dateSelectorPanel.js",
        "appDownloadBridge": "global/app_download_bridge.min.js",
        "starLazyload": "plugins/lazyload/starLazyload.min.js",
        "footer": "modules/footer/footer.js"
    },
    map: [[/(\.css$)/, "$1?v=" + (window.m2015Config && window.m2015Config.timeStamp || "2016021403")], [/(\.js$)/, "$1?v=" + (window.m2015Config && window.m2015Config.timeStamp || "2016021403")]]
});
;seajs.use(["zepto", "hammer", "Storage", "gps"], function(t, e, i, a) {
    var n = "INDEX_CIYT_HISTORY";
    var o = new i({
        type: "local"
    });
    var r = {
        name: "上海",
        code: "2500",
        letter: "sh"
    };
    a.getGPS(function(t) {
        r = t
    });
    var c = {
        init: function() {
            this.$root = t("#J-city-root");
            this.$cityEl = t("#cityEl");
            this._makeHistoryCity();
            t("#J-loadding").hide();
            this._HighLightUserCity();
            this._initPositionCity();
            this.bindEvent()
        },
        bindEvent: function() {
            this.bindSearchEvent();
            this.bindSelectEvent();
            this.bindTouchEvent()
        },
        bindSearchEvent: function() {
            var e = this;
            var i = t("input.search_input");
            var a = t("#J-suggest-list");
            var n = t(".search-box");
            i.on("focus", function() {
                e.$root.addClass("search-state");
                n.find(".cancel").show()
            }).on("input", function() {
                var i = t(this).val().trim();
                e.$root.addClass("search-state");
                n.find(".cancel").show();
                if (e.timeout) {
                    clearTimeout(e.timeout)
                }
                e.timeout = setTimeout(function() {
                    var n = e.timeout;
                    if (!i) {
                        return
                    }
                    var o = "?key=" + encodeURIComponent(i);
                    t.ajax({
                        type: "GET",
                        url: window.TN_DATA && window.TN_DATA.searAjax + o,
                        dataType: "json",
                        success: function(i) {
                            if (n !== e.timeout) {
                                return
                            }
                            a.empty();
                            if (i.data && i.data.length) {
                                var o = i.data
                                  , c = "";
                                o.forEach(function(t, i) {
                                    c += '<li class="thin-border ' + (e.isCityEqual(t, r) ? "selected" : "") + '">';
                                    c += '<p class="J-city_item" data-code="' + t["code"] + '" data-name="' + t["name"] + '" data-letter="' + t["letter"] + '">' + t["name"] + "</p>";
                                    c += "</li>"
                                });
                                a.html(t(c))
                            } else {
                                a.html(t('<p class="empty-text">查询后无此城市</p>'))
                            }
                        },
                        complete: function(t) {}
                    })
                }, 600);
                n.find(".search-clear").addClass("show")
            });
            n.on("click", ".cancel", function(o) {
                a.empty();
                i.val("").blur();
                n.find(".search-clear").removeClass("show");
                e.$root.removeClass("search-state");
                t(this).hide();
                return false
            }).on("click", ".search-clear", function(e) {
                a.empty();
                i.val("");
                t(e.target).removeClass("show")
            })
        },
        bindSelectEvent: function() {
            var e = this;
            this.$root.on("click", ".J-city_item", function(i) {
                var a = t(i.currentTarget);
                a.addClass("active");
                setTimeout(function() {
                    a.removeClass("active")
                }, 300);
                var n = {
                    code: a.data("code"),
                    letter: a.data("letter"),
                    name: a.data("name")
                };
                if (window.TN_DATA && window.TN_DATA.jumpUrl && n.letter) {
                    e._addHistoryCity(n);
                    location.href = TN_DATA.jumpUrl.replace(/\{letter\}/g, n.letter).replace(/\{code\}/g, a.data("code")).replace(/\{name\}/g, a.data("name"))
                } else {
                    location.href = "/"
                }
            })
        },
        _makeHistoryCity: function() {
            var e = o.get(n);
            if (!t("#J-history-city") || !e || !e.length) {
                t("#indexer-hot").hide();
                return
            }
            var i = '<div class="special-title" data-index="历史">历史纪录</div>';
            i += '<ul class="textContainer">';
            for (var a = 0; a < e.length; a++) {
                var r = e[a];
                i += '<li class="textItem J-city_item" data-code="' + r.code + '" data-name="' + r.name + '" data-letter="' + r.letter + '">                    <div class="textItemTitle">' + r.name + "</div>                    </li>"
            }
            i += "</ul>";
            t("#J-history-city").html(i)
        },
        _HighLightUserCity: function() {
            var e = this;
            this.$root.find(".J-city_item").each(function(i, a) {
                var n = t(a);
                var o = {
                    name: n.data("name"),
                    letter: n.data("letter"),
                    code: n.data("code")
                };
                if (e.isCityEqual(o, r)) {
                    n.addClass("selected")
                }
            })
        },
        _initPositionCity: function() {
            var e = this;
            var i = t("#J-position-ctn");
            var n = function() {
                return '<p class="error-position"><i class="icon-refresh"></i>无法获取您的位置，请你选择较近的预定城市</p>'
            };
            var o = function() {
                return '<p class="icon-logo is-positioning">正在获取您的位置</p>'
            };
            var c = function() {
                var t = setTimeout(function() {
                    i.html(n())
                }, 5e3);
                a.getAutoGPS(function(a) {
                    clearTimeout(t);
                    if (a && a.name) {
                        var o = e.isCityEqual(a, r) ? "selected" : "";
                        i.html('<li class="textItem J-city_item ' + o + '"  data-code="' + a.code + '" data-name="' + a.name + '"                         data-letter="' + a.letter + '">                        <div class="textItemTitle thin-border">' + a.name + "</div>                        </li>")
                    } else {
                        i.html(n())
                    }
                })
            };
            c();
            i.on("click", ".icon-refresh", function() {
                i.html(o());
                c()
            })
        },
        isCityEqual: function(t, e) {
            return null != t && null != e && t.name === e.name && t.code == e.code
        },
        _addHistoryCity: function(t) {
            var e = this;
            var i = o.get(n);
            console.log(i);
            if (i == null ) {
                i = []
            }
            t.timestamp = Date.now();
            var a = [t];
            i.forEach(function(t) {
                for (var i = 0; i < a.length; i++) {
                    if (e.isCityEqual(a[i], t)) {
                        return true
                    }
                }
                if (a.length < 4) {
                    a.push(t)
                }
            });
            o.set(n, a);
            localStorage.setItem("userGPS", JSON.stringify(t));
            var r = new Date;
            r.setTime(r.getTime() + 1209600 * 1e3);
            document.cookie = "tuniuuser_citycode=" + escape(window.btoa(t.code)) + ";domain=tuniu.com;path=/;expires=" + r.toUTCString();
            localStorage.setItem("lastAlertTime", r.getTime())
        },
        bindTouchEvent: function() {
            var i = this;
            var a = t("#letterIndexer");
            var n = t("#J-big-show-letter");
            var o;
            var r = new e(a[0],{
                recognizers: [[e.Swipe]]
            });
            var c = t(".city_summary_item", a).map(function(e, i) {
                return t(i).data("key")
            });
            var s = function(e) {
                o = t(e.target);
                if (o.attr("data-key")) {
                    d(o.data("key"))
                } else {
                    o = null
                }
            };
            var l = function() {
                if (i.timeout) {
                    clearTimeout(i.timeout)
                }
                i.timeout = setTimeout(function() {
                    if (o) {
                        var t = f(o, r.session.lastInterval.deltaY);
                        d(t);
                        if (t != null && t.length == 1) {
                            m(t)
                        }
                    }
                }, 0)
            };
            var u = function() {
                setTimeout(function() {
                    h()
                }, 80)
            };
            var d = function(e) {
                var i = 0;
                if (e != null && e.length == 1) {
                    m(e)
                }
                var a = t("#J-index_" + e);
                if (a.length != 0) {
                    i = a.offset().top - 45
                }
                console.log(e + "  " + i);
                t(window).scrollTop(i)
            };
            var h = function() {
                n.removeClass("show").text("")
            };
            var m = function(t) {
                n.addClass("show").text(t)
            };
            var f = function(t, e) {
                var i = t.height()
                  , a = Math.floor(e / i)
                  , n = c.indexOf(t.attr("data-key")) + a;
                return 0 > n ? n = 0 : n > c.length - 1 && (n = c.length - 1),
                c[n]
            };
            a.on("touchstart", function(t) {
                t.preventDefault();
                s(t)
            }).on("touchmove", function(t) {
                l()
            }).on("touchcancel", function(t) {
                u()
            }).on("touchend", function(t) {
                u()
            }).on("click", "li", function(e) {
                var i = t(this);
                d(i.data("key"));
                setTimeout(function() {
                    h()
                }, 400)
            })
        }
    };
    c.init()
});
;(function(ele) {
    if (ele.getAttribute("onclick").indexOf("history.go") != -1 || ele.getAttribute("onclick").trim().indexOf("javascript:void") == 0 || ele.getAttribute("onclick").trim().indexOf("javascript:;") == 0) {
        ele.removeAttribute("onclick");
        ele.addEventListener("click", function(e) {
            e.preventDefault();
            if (this.getAttribute("url")) {
                window.location = this.getAttribute("url");
                return
            }
            if (document.referrer.indexOf("tuniu") >= 0) {
                if (/qq/i.test(navigator.userAgent)) {
                    window.location = document.referrer
                } else {
                    history.go(-1)
                }
            } else {
                window.location = "/"
            }
        }, false)
    }
})(document.querySelector(".header-back"));
